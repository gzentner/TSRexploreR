<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TSS and TSR Analysis • TSRexploreR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="TSS and TSR Analysis">
<meta property="og:description" content="This package analyzes STRIPE-seq data by generating various plots and statistics related to TSSs and TSRs.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">TSRexploreR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/BAM_PROCESSING.html">BAM Processing</a>
    </li>
    <li>
      <a href="articles/DATA_CONDITIONING.html">Data Conditioning</a>
    </li>
    <li>
      <a href="articles/DIFF_FEATURES.html">Differential Feature Analysis</a>
    </li>
    <li>
      <a href="articles/FEATURE_SHIFT.html">TSS Shifting</a>
    </li>
    <li>
      <a href="articles/STANDARD_ANALYSIS.html">Standard Analysis</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="tsrexplorer" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#tsrexplorer" class="anchor"></a>TSRexploreR</h1></div>
<p>TSRexploreR facilitates processing and exploration of data generated by global transcription start site (TSS) mapping technologies such as <a href="https://link.springer.com/protocol/10.1007%2F978-1-4939-0805-9_7">CAGE</a> and <a href="https://genome.cshlp.org/content/30/6/910.long">STRIPE-seq</a>. TSSs can be extracted and aggregated from mapped reads in BAM/SAM format or pre-aggregated TSSs in GRanges, bigWig, bedGraph, or CTSS format can be imported. TSSs can then be normalized and clustered into transcription start regions (TSRs), or TSRs detected with other software such as <a href="https://academic.oup.com/nar/article/43/8/e51/2414172">CAGEr</a> can be imported.</p>
<p>A strength of TSRexploreR is the flexibility and ease with which data can be visualized. Numerous plots can be generated for TSSs and TSRs such as density plots, heatmaps, sequence logos, gene tracks, correlation heatmaps, and many more. For most plots, we also provide the ability to filter, order, quantile, and group TSSs or TSRs by various metrics such as inter-quantile range, shape index, and score. TSRexploreR also facilitates detection of differential TSR usage with <a href="https://genomebiology.biomedcentral.com/articles/10.1186/s13059-014-0550-8">DESeq2</a> and <a href="https://academic.oup.com/bioinformatics/article/26/1/139/182458">edgeR</a>.</p>
<p>We also introduce a new approach to discovering shifts in TSS distributions within merged TSRs from distinct samples. TSRexploreR calculates a signed version of <a href="https://en.wikipedia.org/wiki/Earth_mover%27s_distance">earth mover’s distance</a>, which we term earth mover’s score (EMS), which indicates both the magnitude and direction of a shift. EMS calculation is statistically controlled by a permutation test, which generates a p-value and FDR threshold.</p>
<div id="installing-tsrexplorer" class="section level2">
<h2 class="hasAnchor">
<a href="#installing-tsrexplorer" class="anchor"></a>Installing TSRexploreR</h2>
<p>TSRexploreR can be installed wholly from Github (with or without a <a href="https://docs.conda.io/en/latest/">conda</a> environment) or run from within a <a href="https://singularity.lbl.gov">Singularity</a> container.</p>
<div id="github" class="section level4">
<h4 class="hasAnchor">
<a href="#github" class="anchor"></a>Github</h4>
<pre><code><a href="https://rdrr.io/r/base/Sys.setenv.html">Sys.setenv("R_REMOTES_NO_ERRORS_FROM_WARNINGS"="true")
devtools::install_github("zentnerlab/TSRexploreR")</a></code></pre>
</div>
<div id="github-and-conda" class="section level4">
<h4 class="hasAnchor">
<a href="#github-and-conda" class="anchor"></a>Github and conda</h4>
<p>Conda can be optionally used before the above Github installation step to download most of the package dependencies. This also has the benefit of creating an R environment separate from your main software environment, which helps avoid dependency version conflicts and makes removing associated sofware easy if desired. Installation instructions for miniconda3 can be found <a href="https://docs.conda.io/projects/conda/en/latest/user-guide/install/">here</a>.</p>
<p>First, create the conda environment.</p>
<pre><code>conda create -n TSRexploreR -y -c conda-forge -c bioconda \
qpdf r-base&gt;=4.0.0 r-tidyverse r-data.table r-devtools r-ggseqlogo r-cowplot r-rcpp \
r-assertthat r-testthat r-cairo r-ggrastr r-pkgdown \
bioconductor-apeglm bioconductor-genomicranges bioconductor-genomicfeatures \
bioconductor-genomicalignments bioconductor-biostrings bioconductor-rsamtools \
bioconductor-chipseeker bioconductor-edger bioconductor-deseq2 bioconductor-clusterProfiler \
bioconductor-complexheatmap bioconductor-cager bioconductor-tsrchitect bioconductor-gviz \
bioconductor-rtracklayer bioconductor-biocgenerics bioconductor-plyranges \
bioconductor-pcatools bioconductor-genomeinfodb bioconductor-bsgenome bioconductor-bioccheck \
bioconductor-bsgenome.scerevisiae.ucsc.saccer3 bioconductor-txdb.scerevisiae.ucsc.saccer3.sgdgene</code></pre>
<p>After the environment has been created, it must be activated prior to use.</p>
<pre><code>conda activate TSRexploreR</code></pre>
<p>TSRexploreR can now be installed into this environment, where it will be available upon activation of the environment.</p>
<pre><code><a href="https://rdrr.io/r/base/Sys.setenv.html">Sys.setenv("R_REMOTES_NO_ERRORS_FROM_WARNINGS"="true")
devtools::install_github("zentnerlab/TSRexploreR")</a></code></pre>
</div>
<div id="singularity" class="section level4">
<h4 class="hasAnchor">
<a href="#singularity" class="anchor"></a>Singularity</h4>
<p>The TSRexploreR Singularity container is akin to a box that contains TSRexploreR and all required dependencies. The advantage of containerized software is that it requires no installation (beyond the main container software), is self-contained, and provides stable and reproducible results over time. Singularity installation instructions can be found <a href="https://sylabs.io/docs/">here</a>.</p>
<p>After Singularity is installed, the container can be pulled and run in a few commands. First, create a working directory with all required files and run the following commands.</p>
<p>Download the singularity container.</p>
<pre><code>singularity pull --arch amd64 library://zentlab/default/tsrexplorer:main</code></pre>
<p>You can then run R from within the container housing TSRexploreR.</p>
<pre><code>singularity exec -eCB `pwd` -H `pwd` tsrexplorer_main.sif R</code></pre>
</div>
</div>
<div id="using-tsrexplorer" class="section level2">
<h2 class="hasAnchor">
<a href="#using-tsrexplorer" class="anchor"></a>Using TSRexploreR</h2>
<p>We provide several vignettes to showcase the various functionalities of TSRexplorer:</p>
<ul>
<li>
<a href="documentation/STANDARD_ANALYSIS.pdf">Standard Analysis</a> - Common workflow steps for TSS and TSR analysis and visualization.</li>
<li>
<a href="documentation/BAM_PROCESSING.pdf">BAM Processing</a> - Importing and processing aligned reads from BAM/SAM format.</li>
<li>
<a href="documentation/DIFF_FEATURES.pdf">Differential TSSs/TSRs</a> - Using DESeq2 or edgeR to find differential TSSs or TSRs between conditions.</li>
<li>
<a href="documentation/FEATURE_SHIFT.pdf">TSS Shifting</a> - Detecting shifts in TSS distributions within TSRs between conditions using the earth mover’s score (EMS).</li>
<li>
<a href="documentation/DATA_CONDITIONING.pdf">Data Conditionals</a> - Flexible filtering, quantiling, ordering, and grouping TSSs or TSRs during plotting.</li>
</ul>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Robert Policastro <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/YOUR-ORCID-ID" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Robert Policastro.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
