<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Standard Analysis • TSRexploreR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Standard Analysis">
<meta property="og:description" content="TSRexploreR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TSRexploreR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/BAM_PROCESSING.html">BAM Processing</a>
    </li>
    <li>
      <a href="../articles/DATA_CONDITIONING.html">Data Conditioning</a>
    </li>
    <li>
      <a href="../articles/DIFF_FEATURES.html">Differential Feature Analysis</a>
    </li>
    <li>
      <a href="../articles/FEATURE_SHIFT.html">TSS Shifting</a>
    </li>
    <li>
      <a href="../articles/STANDARD_ANALYSIS.html">Standard Analysis</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="STANDARD_ANALYSIS_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Standard Analysis</h1>
            
      
      
      <div class="hidden name"><code>STANDARD_ANALYSIS.Rmd</code></div>

    </div>

    
    
<p>A Transcription Start Site (TSS) represents the position of the first base of a transcript to be transcribed by an RNA polymerase. Most genes do not have a single TSS, but rather a collection of TSS positions collectively referred to as a Transcription Start Region (TSR). Variation in TSS selection influences transcript stability (<a href="https://elifesciences.org/articles/06722">Malabat et al. 2015</a>) and translation (<a href="https://rnajournal.cshlp.org/content/18/12/2299.long">Rojas-Duran and Gilbert 2012</a>) as well as the domain composition (<a href="http://www.plantcell.org/content/27/12/3309">Mejía-Guerra et al. 2015</a>) or localization (<a href="https://www.sciencedirect.com/science/article/pii/S0092867417312400">Ushijima et al. 2018</a>) of the encoded protein. Furthermore, variations in TSS usage have been observed during organismal development (<a href="https://www.nature.com/articles/nature12974">Haberle et al. 2014</a>, <a href="https://bmcgenomics.biomedcentral.com/articles/10.1186/s12864-017-3834-z">Zhang et al. 2017</a>, <a href="https://bmcgenomics.biomedcentral.com/articles/10.1186/s12864-018-4504-5">Danks et al. 2018</a>) as well as in diseases such as cancer (<a href="https://www.cell.com/cell/fulltext/S0092-8674(19)30906-7?_returnURL=https%3A%2F%2Flinkinghub.elsevier.com%2Fretrieve%2Fpii%2FS0092867419309067%3Fshowall%3Dtrue">Demircioğlu et al. 2019</a>).</p>
<p>TSRexploreR offers a series of analysis and plotting functions that allow deep exploration of TSSs and TSRs. Here, we describe the standard TSRexploreR analysis pipeline.</p>
<div id="preparing-data" class="section level2">
<h2 class="hasAnchor">
<a href="#preparing-data" class="anchor"></a>Preparing Data</h2>
<p>This example uses a set of <em>S. cerevisiae</em> TSSs identified with <a href="https://genome.cshlp.org/content/30/6/910.long">STRIPE-seq</a>. There are many ways to import TSSs into TSRexploreR; this vignette uses a named list of GRanges as input into the function that creates the TSRexploreR object.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"TSRexploreR"</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org">"ggplot2"</a></span><span class="op">)</span>

<span class="co"># Load example TSSs</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">TSSs</span><span class="op">)</span>

<span class="co"># Keep only the WT sample for now</span>
<span class="va">TSSs</span> <span class="op">&lt;-</span> <span class="va">TSSs</span><span class="op">[</span><span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">TSSs</span><span class="op">)</span>, <span class="st">"WT"</span><span class="op">)</span><span class="op">]</span>

<span class="co"># Load genome assembly and annotation</span>
<span class="va">assembly</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"S288C_Assembly.fasta"</span>, package<span class="op">=</span><span class="st">"TSRexploreR"</span><span class="op">)</span>
<span class="va">annotation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"S288C_Annotation.gtf"</span>, package<span class="op">=</span><span class="st">"TSRexploreR"</span><span class="op">)</span>

<span class="co"># Generate sample sheet</span>
<span class="va">sample_sheet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  sample_name<span class="op">=</span><span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_glue.html">str_glue</a></span><span class="op">(</span><span class="st">"S288C_WT_{seq_len(3)}"</span><span class="op">)</span>,
  file_1<span class="op">=</span><span class="cn">NA</span>, file_2<span class="op">=</span><span class="cn">NA</span>,
  condition<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Untreated"</span>, <span class="fl">3</span><span class="op">)</span>
<span class="op">)</span>

<span class="co"># Create the TSRexploreR object</span>
<span class="va">exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tsr_explorer-class.html">tsr_explorer</a></span><span class="op">(</span>
  <span class="va">TSSs</span>,
  sample_sheet<span class="op">=</span><span class="va">sample_sheet</span>,
  genome_annotation<span class="op">=</span><span class="va">annotation</span>,
  genome_assembly<span class="op">=</span><span class="va">assembly</span>
<span class="op">)</span></code></pre></div>
</div>
<div id="initial-tss-processing" class="section level2">
<h2 class="hasAnchor">
<a href="#initial-tss-processing" class="anchor"></a>Initial TSS Processing</h2>
<p>After the TSSs are loaded into the TSRexploreR object, a few processing steps are necessary in order to prepare the data for analysis.</p>
<div id="format-tsss" class="section level3">
<h3 class="hasAnchor">
<a href="#format-tsss" class="anchor"></a>Format TSSs</h3>
<p>The first step is to convert the TSSs into a table that will facilitate downstream analysis.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/format_counts.html">format_counts</a></span><span class="op">(</span><span class="va">exp</span>, data_type<span class="op">=</span><span class="st">"tss"</span><span class="op">)</span></code></pre></div>
</div>
<div id="normalize-tsss" class="section level3">
<h3 class="hasAnchor">
<a href="#normalize-tsss" class="anchor"></a>Normalize TSSs</h3>
<p>The next step is to normalize TSS counts. There are three options: counts per million (CPM), median of ratios (MOR, implemented in <a href="https://genomebiology.biomedcentral.com/articles/10.1186/s13059-014-0550-8">DESeq2</a>), and <a href="https://genomebiology.biomedcentral.com/articles/10.1186/gb-2010-11-3-r25">trimmed median of M-values (TMM)</a>, implemented in <a href="https://academic.oup.com/bioinformatics/article/26/1/139/182458">edgeR</a>. MOR and TMM are recommended for comparison between samples from different conditions. If the counts you input were already normalized, this step can be safely skipped.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/normalize_counts.html">normalize_counts</a></span><span class="op">(</span><span class="va">exp</span>, data_type<span class="op">=</span><span class="st">"tss"</span>, method<span class="op">=</span><span class="st">"DESeq2"</span><span class="op">)</span></code></pre></div>
</div>
<div id="tss-annotation" class="section level3">
<h3 class="hasAnchor">
<a href="#tss-annotation" class="anchor"></a>TSS Annotation</h3>
<p>After formatting counts and optionally normalizing them, TSSs are annotated relative to known genomic features. This function takes either the path and file name of a ‘GTF’ or ‘GFF’ file or a ‘TxDb’ package from Bioconductor. The example below uses a ‘GTF’ file from Ensembl (R64-1-1 Release 99) and annotates each TSS to the annotated start of the nearest gene.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/annotate_features.html">annotate_features</a></span><span class="op">(</span><span class="va">exp</span>, data_type<span class="op">=</span><span class="st">"tss"</span>, feature_type<span class="op">=</span><span class="st">"transcript"</span><span class="op">)</span></code></pre></div>
</div>
<div id="naive-threshold-exploration" class="section level3">
<h3 class="hasAnchor">
<a href="#naive-threshold-exploration" class="anchor"></a>Naive Threshold Exploration</h3>
<p>All TSS mapping methods contain some degree of background in the form of low-count TSSs, particularly within gene bodies. This background can complicate downstream analysis, but it can largely be removed via a simple thresholding approach wherein TSSs below a certain number of counts are removed from further consideration. If a genome annotation is available, a thresholding plot may help in picking this count threshold. In this approach, the fraction of TSSs that are promoter-proximal is plotted against a range of read thresholds. The number of features (genes or transcripts) with at least one unique TSS position at each threshold is also indicated graphically.</p>
<p>We note that most plotting functions in TSRexploreR return ggplot objects. This will be explicity stated under the ‘Value’ section of the function help documentation (e.g. <code><a href="../reference/plot_threshold_exploration.html">?plot_threshold_exploration</a></code>). ggplot objects can be customized beyond a select few style arguments in the plotting functions with standard ggplot2 syntax as demonstrated below.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_threshold_exploration.html">plot_threshold_exploration</a></span><span class="op">(</span><span class="va">exp</span>, samples<span class="op">=</span><span class="st">"S288C_WT_1"</span>, point_size<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_color_viridis_c</a></span><span class="op">(</span><span class="op">)</span> </code></pre></div>
<p><img src="STANDARD_ANALYSIS_files/figure-html/unnamed-chunk-5-1.png" width="384" style="display: block; margin: auto;"></p>
<p>Looking at the plot, a threshold of three or more reads is a sensible choice: there is a precipitous drop in detected features for a comparatively low gain in promoter-proximal TSS fraction at higher thresholds. Next we, apply this threshold to the data, dropping any TSS without at least 3 counts in one sample.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/apply_threshold.html">apply_threshold</a></span><span class="op">(</span><span class="va">exp</span>, threshold<span class="op">=</span><span class="fl">3</span>, n_samples<span class="op">=</span><span class="fl">1</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="tss-correlation" class="section level2">
<h2 class="hasAnchor">
<a href="#tss-correlation" class="anchor"></a>TSS Correlation</h2>
<p>Assessing correlation between samples provides information on replicate similarity and can also give a cursory indication of the degree of difference between biologically distinct samples (e.g. different genotypes or treatments).</p>
<div id="correlation-matrix-plots" class="section level3">
<h3 class="hasAnchor">
<a href="#correlation-matrix-plots" class="anchor"></a>Correlation Matrix Plots</h3>
<p>For correlation analysis, MOR- or TMM-normalized should be used. By default, Pearson correlation analysis is performed.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_correlation.html">plot_correlation</a></span><span class="op">(</span>
  <span class="va">exp</span>, data_type<span class="op">=</span><span class="st">"tss"</span>,
  use_normalized<span class="op">=</span><span class="cn">TRUE</span>, font_size<span class="op">=</span><span class="fl">12</span>,
  heatmap_colors<span class="op">=</span><span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/viridisLite/man/viridis.html">viridis</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="STANDARD_ANALYSIS_files/figure-html/unnamed-chunk-7-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="tss-genomic-distribution" class="section level2">
<h2 class="hasAnchor">
<a href="#tss-genomic-distribution" class="anchor"></a>TSS Genomic Distribution</h2>
<p>As part of the initial TSS processing, TSSs are annotated relative to known features. This information can be used to explore the genomic distribution of TSSs. Additionally, it can be used to plot the total number of detected features and the number of detected features with a promoter-proximal TSS.</p>
<div id="genomic-distribution-plot" class="section level3">
<h3 class="hasAnchor">
<a href="#genomic-distribution-plot" class="anchor"></a>Genomic Distribution Plot</h3>
<p>A stacked bar plot can be generated to showcase the fractional distribution of TSSs relative to known features.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_genomic_distribution.html">plot_genomic_distribution</a></span><span class="op">(</span><span class="va">exp</span>, data_type<span class="op">=</span><span class="st">"tss"</span>, samples<span class="op">=</span><span class="st">"S288C_WT_1"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_d</a></span><span class="op">(</span>direction<span class="op">=</span><span class="op">-</span><span class="fl">1</span>, name<span class="op">=</span><span class="st">"Annotation"</span><span class="op">)</span></code></pre></div>
<p><img src="STANDARD_ANALYSIS_files/figure-html/unnamed-chunk-8-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div id="feature-detection-plot" class="section level3">
<h3 class="hasAnchor">
<a href="#feature-detection-plot" class="anchor"></a>Feature Detection Plot</h3>
<p>The number of features detected and fraction of features with a promoter-proximal TSSs can be displayed as a stacked barplot.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_detected_features.html">plot_detected_features</a></span><span class="op">(</span><span class="va">exp</span>, data_type<span class="op">=</span><span class="st">"tss"</span>, samples<span class="op">=</span><span class="st">"S288C_WT_1"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_d</a></span><span class="op">(</span>direction<span class="op">=</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="STANDARD_ANALYSIS_files/figure-html/unnamed-chunk-9-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div id="density-plots" class="section level3">
<h3 class="hasAnchor">
<a href="#density-plots" class="anchor"></a>Density Plots</h3>
<p>Density plots are useful for visualizing where TSSs tend to be located relative to annotated TSSs. The current yeast genome annotation does not contain information on 5’ UTRs, so density plots are centered on annotated start codons and it is expected that the maximum density would be slightly upstream of the plot center. Most other organisms have 5’ UTR information in their genome annotations, with the UTR length corresponding to the distance between the start codon and the most distal TSS detected. This would result in a centered density plot.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_density.html">plot_density</a></span><span class="op">(</span><span class="va">exp</span>, data_type<span class="op">=</span><span class="st">"tss"</span>, samples<span class="op">=</span><span class="st">"S288C_WT_1"</span><span class="op">)</span></code></pre></div>
<p><img src="STANDARD_ANALYSIS_files/figure-html/unnamed-chunk-10-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div id="heatmaps" class="section level3">
<h3 class="hasAnchor">
<a href="#heatmaps" class="anchor"></a>Heatmaps</h3>
<p>While a density plot gives an overview of TSS distribution relative to annotated start codons or TSSs, it does not illustrate the strength of its constituent TSS positions. To visualize TSS signal relative to the start positions of all annotated features (genes or transcript), a heatmap can be generated. However, as TSS are single points and may be sparsely distributed, it can be somewhat difficult to visualize them as a heatmap.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_heatmap.html">plot_heatmap</a></span><span class="op">(</span>
  <span class="va">exp</span>, data_type<span class="op">=</span><span class="st">"tss"</span>, samples<span class="op">=</span><span class="st">"S288C_WT_1"</span>,
  upstream<span class="op">=</span><span class="fl">250</span>, downstream<span class="op">=</span><span class="fl">250</span>,
  use_normalized<span class="op">=</span><span class="cn">TRUE</span>,
  rasterize<span class="op">=</span><span class="cn">TRUE</span>, raster_dpi<span class="op">=</span><span class="fl">150</span>
<span class="op">)</span></code></pre></div>
<p><img src="STANDARD_ANALYSIS_files/figure-html/unnamed-chunk-11-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="sequence-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#sequence-analysis" class="anchor"></a>Sequence Analysis</h2>
<p>TSSs tend to occur within certain sequence contexts, and this context can vary between species. Knowing this TSS sequence bias can give mechanistic and biologically relevant information on promoter structure.</p>
<div id="tss-sequence-logo" class="section level3">
<h3 class="hasAnchor">
<a href="#tss-sequence-logo" class="anchor"></a>TSS Sequence Logo</h3>
<p>Generating sequence logos around TSSs is a good first step in determining the sequence context of TSSs. For example, in <em>S. cerevisiae</em> it has been reported that there is a pyrimidine-purine bias at the -1 and +1 positions, respectively (<a href="https://academic.oup.com/nar/article/33/9/2838/2401448">Zhang and Dietrich 2005</a>). Furthermore, stronger TSSs tend to have an adenine at the -8 position (<a href="https://genome.cshlp.org/content/30/6/910.long">Policastro et al. 2020</a>, <a href="https://genomebiology.biomedcentral.com/articles/10.1186/s13059-020-02040-0">Qiu et al. 2020</a>).</p>
<p>To analyze TSS sequence context, TSRexploreR retrieves sequences centered on TSSs from a ‘FASTA’ genome assembly or ‘BSgenome’ object. This example uses the Ensembl R64-1-1 Release 99 FASTA.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_sequence_logo.html">plot_sequence_logo</a></span><span class="op">(</span><span class="va">exp</span>, samples<span class="op">=</span><span class="st">"S288C_WT_1"</span><span class="op">)</span></code></pre></div>
<p><img src="STANDARD_ANALYSIS_files/figure-html/unnamed-chunk-12-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div id="sequence-color-map" class="section level3">
<h3 class="hasAnchor">
<a href="#sequence-color-map" class="anchor"></a>Sequence Color Map</h3>
<p>A sequence logo compresses positional information into a compact form, providing the amount of information each base contributes to the “average” sequence of each base in the TSS window. Sequence information can also be viewed without aggregation as a sequence color map, wherein each row represents the window around a TSS and each column represents a specific position relative to this TSS. These display conventions are analogous to those used in a heatmap. Each base is assigned a color and displayed in this two-dimensional space. The prevalence of colors in certain positions can give further evidence of specific sequence contexts. The same genome assembly and retrieved sequences that were used to make the sequence logos above are used here.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_sequence_colormap.html">plot_sequence_colormap</a></span><span class="op">(</span><span class="va">exp</span>, samples<span class="op">=</span><span class="st">"S288C_WT_1"</span>, rasterize<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="STANDARD_ANALYSIS_files/figure-html/unnamed-chunk-13-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div id="dinucleotide-frequency" class="section level3">
<h3 class="hasAnchor">
<a href="#dinucleotide-frequency" class="anchor"></a>Dinucleotide Frequency</h3>
<p>As previously discused, organisms often have a specific TSS sequence context. This function explores the fraction of each potential dinucleotide at the -1/+1 positions of all TSSs, where the +1 position is the TSS.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_dinucleotide_frequencies.html">plot_dinucleotide_frequencies</a></span><span class="op">(</span><span class="va">exp</span>, samples<span class="op">=</span><span class="st">"S288C_WT_1"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_c</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="STANDARD_ANALYSIS_files/figure-html/unnamed-chunk-14-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="clustering-tsss" class="section level2">
<h2 class="hasAnchor">
<a href="#clustering-tsss" class="anchor"></a>Clustering TSSs</h2>
<p>Transcription initiation is rarely homogenous; it is generally the case that a gene will have multiple TSSs clustered into a TSR, and so analyzing TSRs versus individual TSSs will provide more realistic information on initiation. Moreover, TSR shape features have been shown to correlate with differential enrichment of core promoter motifs (<a href="https://www.nature.com/articles/ng1789">Carninci et al. 2006</a>, <a href="https://genome.cshlp.org/content/21/2/182.long">Hoskins et al. 2011</a>, <a href="https://genome.cshlp.org/content/28/12/1943.full">Cvetesic et al. 2019</a>), as well as distinct gene classes (<a href="https://genome.cshlp.org/content/29/7/1198.full">Lu and Lin 2019</a>).</p>
<div id="distance-clustering" class="section level3">
<h3 class="hasAnchor">
<a href="#distance-clustering" class="anchor"></a>Distance Clustering</h3>
<p>To identify TSRs, TSRexploreR uses a distance clustering method. This approach groups TSSs that pass a certain read threshold and are within a certain distance of one another into TSRs. Alteratively, if you have called TSRs using other methods (e.g. <a href="https://genome.cshlp.org/content/18/1/1.long">Paraclu</a> or <a href="https://bmcgenomics.biomedcentral.com/articles/10.1186/1471-2164-15-269">RECLU</a>), they can be imported directly. Here, we cluster TSSs supported by at least 3 counts into TSRs.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tss_clustering.html">tss_clustering</a></span><span class="op">(</span><span class="va">exp</span>, threshold<span class="op">=</span><span class="fl">3</span>, max_distance<span class="op">=</span><span class="fl">25</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning in .local(x, row.names, optional, ...): Arguments in '...' ignored

## Warning in .local(x, row.names, optional, ...): Arguments in '...' ignored

## Warning in .local(x, row.names, optional, ...): Arguments in '...' ignored

## Warning in .local(x, row.names, optional, ...): Arguments in '...' ignored

## Warning in .local(x, row.names, optional, ...): Arguments in '...' ignored

## Warning in .local(x, row.names, optional, ...): Arguments in '...' ignored</code></pre>
</div>
<div id="associating-tsss-with-tsrs" class="section level3">
<h3 class="hasAnchor">
<a href="#associating-tsss-with-tsrs" class="anchor"></a>Associating TSSs with TSRs</h3>
<p>TSRexploreR provides great flexibility for working with TSSs and TSRs. After TSRs are called or imported, TSSs can be assigned to TSRs with which they overlap. In this example, TSSs are associated with the TSRs detected above using distance clustering.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/associate_with_tsr.html">associate_with_tsr</a></span><span class="op">(</span><span class="va">exp</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="initial-tsr-processing" class="section level2">
<h2 class="hasAnchor">
<a href="#initial-tsr-processing" class="anchor"></a>Initial TSR Processing</h2>
<p>Now that the TSSs have been clustered and associated with TSRs, the TSRs can undergo initial processing. This involves annotation, calculating various metrics of TSR shape and strength, and optional normalization of TSR scores.</p>
<div id="tsr-metrics" class="section level3">
<h3 class="hasAnchor">
<a href="#tsr-metrics" class="anchor"></a>TSR Metrics</h3>
<p>After TSSs have been associated with TSRs, various metrics describing TSR shape and strength can be computed. First, the dominant TSS (that is, the highest-scoring TSS) within a TSR will be annotated. Then, various shape features such as inter-quantile range, shape index, and balance will be calculated.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mark_dominant.html">mark_dominant</a></span><span class="op">(</span><span class="va">exp</span>, data_type<span class="op">=</span><span class="st">"tss"</span><span class="op">)</span>
<span class="va">exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tsr_metrics.html">tsr_metrics</a></span><span class="op">(</span><span class="va">exp</span><span class="op">)</span></code></pre></div>
</div>
<div id="annotate-tsrs" class="section level3">
<h3 class="hasAnchor">
<a href="#annotate-tsrs" class="anchor"></a>Annotate TSRs</h3>
<p>It is recommended to annotate TSRs if a genome annotation is available.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/annotate_features.html">annotate_features</a></span><span class="op">(</span><span class="va">exp</span>, data_type<span class="op">=</span><span class="st">"tsr"</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="tsr-correlation" class="section level2">
<h2 class="hasAnchor">
<a href="#tsr-correlation" class="anchor"></a>TSR Correlation</h2>
<p>Similar to looking at TSS correlation, assessing TSR correlation before further analysis is good practice.</p>
<div id="correlation-matrix-plots-1" class="section level3">
<h3 class="hasAnchor">
<a href="#correlation-matrix-plots-1" class="anchor"></a>Correlation Matrix Plots</h3>
<p>Normalized TSR counts are determined by summing the normalized counts of all associated TSSs; normalization of TSR counts is not performed directly.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_correlation.html">plot_correlation</a></span><span class="op">(</span>
  <span class="va">exp</span>, data_type<span class="op">=</span><span class="st">"tsr"</span>, n_samples<span class="op">=</span><span class="fl">1</span>,
  threshold<span class="op">=</span><span class="fl">3</span>, use_normalized<span class="op">=</span><span class="cn">TRUE</span>, font_size<span class="op">=</span><span class="fl">12</span>, 
  heatmap_colors<span class="op">=</span><span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/viridisLite/man/viridis.html">viridis</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="STANDARD_ANALYSIS_files/figure-html/unnamed-chunk-19-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="tsr-genomic-distribution" class="section level2">
<h2 class="hasAnchor">
<a href="#tsr-genomic-distribution" class="anchor"></a>TSR Genomic Distribution</h2>
<p>As for TSSs, it is expected that TSRs will be be enriched upstream of annotated start codons. This can be assessed by visualizing their genomic distribution.</p>
<div id="genomic-distribution-plot-1" class="section level3">
<h3 class="hasAnchor">
<a href="#genomic-distribution-plot-1" class="anchor"></a>Genomic Distribution Plot</h3>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_genomic_distribution.html">plot_genomic_distribution</a></span><span class="op">(</span><span class="va">exp</span>, data_type<span class="op">=</span><span class="st">"tsr"</span>, samples<span class="op">=</span><span class="st">"S288C_WT_1"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_d</a></span><span class="op">(</span>direction<span class="op">=</span><span class="op">-</span><span class="fl">1</span>, name<span class="op">=</span><span class="st">"Annotation"</span><span class="op">)</span></code></pre></div>
<p><img src="STANDARD_ANALYSIS_files/figure-html/unnamed-chunk-20-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div id="feature-detection-plot-1" class="section level3">
<h3 class="hasAnchor">
<a href="#feature-detection-plot-1" class="anchor"></a>Feature Detection Plot</h3>
<p>The number of features detected and fraction of features with a promoter-proximal TSSs can be displayed as a stacked barplot.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_detected_features.html">plot_detected_features</a></span><span class="op">(</span><span class="va">exp</span>, data_type<span class="op">=</span><span class="st">"tsr"</span>, samples<span class="op">=</span><span class="st">"S288C_WT_1"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_d</a></span><span class="op">(</span>direction<span class="op">=</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="STANDARD_ANALYSIS_files/figure-html/unnamed-chunk-21-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div id="density-plots-1" class="section level3">
<h3 class="hasAnchor">
<a href="#density-plots-1" class="anchor"></a>Density Plots</h3>
<p>As for TSSs, density plots can be generated for TSRs.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_density.html">plot_density</a></span><span class="op">(</span><span class="va">exp</span>, data_type<span class="op">=</span><span class="st">"tsr"</span>, samples<span class="op">=</span><span class="st">"S288C_WT_1"</span><span class="op">)</span></code></pre></div>
<p><img src="STANDARD_ANALYSIS_files/figure-html/unnamed-chunk-22-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div id="heatmaps-1" class="section level3">
<h3 class="hasAnchor">
<a href="#heatmaps-1" class="anchor"></a>Heatmaps</h3>
<p>TSR heatmaps provide a global view of TSR distribution and strength relative to annotated start codons or TSSs.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_heatmap.html">plot_heatmap</a></span><span class="op">(</span>
  <span class="va">exp</span>, data_type<span class="op">=</span><span class="st">"tsr"</span>, samples<span class="op">=</span><span class="st">"S288C_WT_1"</span>,
  upstream<span class="op">=</span><span class="fl">500</span>, downstream<span class="op">=</span><span class="fl">500</span>,
  use_normalized<span class="op">=</span><span class="cn">TRUE</span>,
  rasterize<span class="op">=</span><span class="cn">TRUE</span>, raster_dpi<span class="op">=</span><span class="fl">150</span>
<span class="op">)</span></code></pre></div>
<p><img src="STANDARD_ANALYSIS_files/figure-html/unnamed-chunk-23-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="tsr-metrics-and-shape" class="section level2">
<h2 class="hasAnchor">
<a href="#tsr-metrics-and-shape" class="anchor"></a>TSR Metrics and Shape</h2>
<p>After clustering TSSs into TSRs, several descriptive and quantative measures were calculated: TSR width, log2 + 1 TSR score, shape index, inter-quantile width, and peak index.</p>
<div id="summary-plots" class="section level3">
<h3 class="hasAnchor">
<a href="#summary-plots" class="anchor"></a>Summary Plots</h3>
<p>Summary plots can be generated for most TSR metrics. In this example, we generate violin plots of the log2 + 1 transformed TSR score and TSR width.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_tsr_metric.html">plot_tsr_metric</a></span><span class="op">(</span><span class="va">exp</span>, tsr_metrics<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"score"</span>, <span class="st">"width"</span><span class="op">)</span>, log2_transform<span class="op">=</span><span class="cn">TRUE</span>, samples<span class="op">=</span><span class="st">"S288C_WT_1"</span><span class="op">)</span></code></pre></div>
<p><img src="STANDARD_ANALYSIS_files/figure-html/unnamed-chunk-24-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="gene-tracks" class="section level2">
<h2 class="hasAnchor">
<a href="#gene-tracks" class="anchor"></a>Gene Tracks</h2>
<p>Viewing TSSs and/or TSRs in gene tracks can be useful for a variety of reasons. It can make clear which 5’ isoforms of a transcript are expressed, hint at potential misannotation of genes, and suggest 5’ UTR length In TSRexploreR, tracks can be created based on a gene/transcript name or genomic coordinates. Additionally, if tracks are generated based on genes/transcripts, the promoter region alone can also be displayed.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/gene_tracks.html">gene_tracks</a></span><span class="op">(</span>
  <span class="va">exp</span>, feature_name<span class="op">=</span><span class="st">"YDR418W"</span>, ymax<span class="op">=</span><span class="fl">80</span>, 
  samples<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>TSS<span class="op">=</span><span class="st">"S288C_WT_1"</span>, TSR<span class="op">=</span><span class="st">"S288C_WT_1"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="STANDARD_ANALYSIS_files/figure-html/unnamed-chunk-25-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div id="data-access" class="section level2">
<h2 class="hasAnchor">
<a href="#data-access" class="anchor"></a>Data Access</h2>
<p>TSRexploreR provides various convenience functions to access or export data stored in the objects. Below is an overview of some of the available functions.</p>
<ul>
<li>
<code>tss_export</code>: Export TSSs as bigWigs, bedgraphs, or as a tabular file.</li>
<li>
<code>tsr_export</code>: Export TSRs as bed or tabular file.</li>
<li>
<code>get_counts</code>: Get TSS or TSR table from object including additional analysis such as annotations, normalized counts, and computed metrics.</li>
<li>
<code>get_diff_results</code>: Get table of differential TSSs or TSRs.</li>
<li>
<code>get_shifting_results</code>: Get table of TSR shifting results.</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Robert Policastro.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
