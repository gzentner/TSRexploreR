<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Plot Threshold Exploration — plot_threshold_exploration • TSRexploreR</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Plot Threshold Exploration — plot_threshold_exploration" />
<meta property="og:description" content="Make a plot to explore threshold values." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TSRexploreR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/BAM_PROCESSING.html">BAM Processing</a>
    </li>
    <li>
      <a href="../articles/DATA_CONDITIONING.html">Data Conditioning</a>
    </li>
    <li>
      <a href="../articles/DIFF_FEATURES.html">Differential Feature Analysis</a>
    </li>
    <li>
      <a href="../articles/FEATURE_SHIFT.html">TSS Shifting</a>
    </li>
    <li>
      <a href="../articles/STANDARD_ANALYSIS.html">Standard Analysis</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot Threshold Exploration</h1>
    
    <div class="hidden name"><code>plot_threshold_exploration.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Make a plot to explore threshold values.</p>
    </div>

    <pre class="usage"><span class='fu'>plot_threshold_exploration</span><span class='op'>(</span>
  <span class='va'>experiment</span>,
  max_threshold <span class='op'>=</span> <span class='fl'>25</span>,
  steps <span class='op'>=</span> <span class='fl'>1</span>,
  samples <span class='op'>=</span> <span class='st'>"all"</span>,
  use_normalized <span class='op'>=</span> <span class='cn'>FALSE</span>,
  ncol <span class='op'>=</span> <span class='fl'>1</span>,
  point_size <span class='op'>=</span> <span class='fl'>1</span>,
  return_table <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>experiment</th>
      <td><p>TSRexploreR object.</p></td>
    </tr>
    <tr>
      <th>max_threshold</th>
      <td><p>Thresholds from 1 to max_threshold will be explored.</p></td>
    </tr>
    <tr>
      <th>steps</th>
      <td><p>Steps to get the threshold values.</p></td>
    </tr>
    <tr>
      <th>samples</th>
      <td><p>A vector of sample names to analyze.</p></td>
    </tr>
    <tr>
      <th>use_normalized</th>
      <td><p>Whether to use the normalized (TRUE) or raw (FALSE) counts.</p></td>
    </tr>
    <tr>
      <th>ncol</th>
      <td><p>Integer specifying the number of columns to arrange multiple plots.</p></td>
    </tr>
    <tr>
      <th>point_size</th>
      <td><p>The size of the points on the plot.</p></td>
    </tr>
    <tr>
      <th>return_table</th>
      <td><p>Return a table of results instead of a plot.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Arguments passed to geom_point.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>ggplot2 object containing the threshold exploration plot</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>All TSSs mapping methods produce spurious TSSs. For the most part, these spurious 
reads TSSs to be weak and somewhat uniformly distributed throughout promoters and
gene bodies. This means that this background can be mitigated by requiring a 
minimum read threshold for a TSS to be considered in downstream analyses.</p>
<p>This plotting function generates a line plot, where the x-axis is the naive read threshold
  and the y-axis is the proportion of TSSs within annotated gene/transcript promoters.
Additionally, the point color represents the absolute number of genes with at least 1 surviving
  TSS after filtering.
'max_threshold' controls the maximum threshold value explored,
  and 'steps' is the value that is used to increment between 1 and 'max_threshold'.</p>
<p>At a certain threshold there are diminishing returns,
  where an increase in threshold results in little increase in promoter-proximal fraction,
  but a precipitous loss in number of genes with a TSS.
A threshold should be chosen that balances these two competing metrics.
For STRIPE-seq, we have found that a threshold of 3 often provides an appropriate balance between
  a high promoter-proximal fraction (&gt;= 0.8) and the number of unique genes or
  transcripts with at least one unique TSS.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='apply_threshold.html'>apply_threshold</a></code> to permantly filter TSSs below threshold value.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>TSSs_reduced</span><span class='op'>)</span>
<span class='va'>annotation</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"extdata"</span>, <span class='st'>"S288C_Annotation.gtf"</span>, package<span class='op'>=</span><span class='st'>"TSRexploreR"</span><span class='op'>)</span>

<span class='va'>exp</span> <span class='op'>&lt;-</span> <span class='va'>TSSs_reduced</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='tsr_explorer-class.html'>tsr_explorer</a></span><span class='op'>(</span>genome_annotation<span class='op'>=</span><span class='va'>annotation</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='format_counts.html'>format_counts</a></span><span class='op'>(</span>data_type<span class='op'>=</span><span class='st'>"tss"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='annotate_features.html'>annotate_features</a></span><span class='op'>(</span>data_type<span class='op'>=</span><span class='st'>"tss"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Import genomic features from the file as a GRanges object ... </span></div><div class='output co'>#&gt; <span class='message'>OK</span></div><div class='output co'>#&gt; <span class='message'>Prepare the 'metadata' data frame ... </span></div><div class='output co'>#&gt; <span class='message'>OK</span></div><div class='output co'>#&gt; <span class='message'>Make the TxDb object ... </span></div><div class='output co'>#&gt; <span class='warning'>Warning: The "phase" metadata column contains non-NA values for features of type</span>
#&gt; <span class='warning'>  stop_codon. This information was ignored.</span></div><div class='output co'>#&gt; <span class='message'>OK</span></div><div class='input'>  
<span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'>plot_threshold_exploration</span><span class='op'>(</span><span class='va'>exp</span><span class='op'>)</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Robert Policastro.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


