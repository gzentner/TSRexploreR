<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Analyze Differential Features — differential_expression • TSRexploreR</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Analyze Differential Features — differential_expression" />
<meta property="og:description" content="Find differential TSSs or TSRs from previously generated edgeR or DESeq2 model." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TSRexploreR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/BAM_PROCESSING.html">BAM Processing</a>
    </li>
    <li>
      <a href="../articles/DATA_CONDITIONING.html">Data Conditioning</a>
    </li>
    <li>
      <a href="../articles/DIFF_FEATURES.html">Differential Feature Analysis</a>
    </li>
    <li>
      <a href="../articles/FEATURE_SHIFT.html">TSS Shifting</a>
    </li>
    <li>
      <a href="../articles/STANDARD_ANALYSIS.html">Standard Analysis</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Analyze Differential Features</h1>
    
    <div class="hidden name"><code>differential_expression.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Find differential TSSs or TSRs from previously generated edgeR or DESeq2 model.</p>
    </div>

    <pre class="usage"><span class='fu'>differential_expression</span><span class='op'>(</span>
  <span class='va'>experiment</span>,
  data_type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"tss"</span>, <span class='st'>"tsr"</span>, <span class='st'>"tss_features"</span>, <span class='st'>"tsr_features"</span><span class='op'>)</span>,
  <span class='va'>comparison_name</span>,
  <span class='va'>comparison_type</span>,
  <span class='va'>comparison</span>,
  shrink_lfc <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>experiment</th>
      <td><p>TSRexploreR object.</p></td>
    </tr>
    <tr>
      <th>data_type</th>
      <td><p>Whether the input was generated from TSSs ('tss') or TSRs ('tsr').</p></td>
    </tr>
    <tr>
      <th>comparison_name</th>
      <td><p>The name given to the comparison when stored back into the TSRexploreR object.</p></td>
    </tr>
    <tr>
      <th>comparison_type</th>
      <td><p>For DEseq2, either 'contrast' or 'name'. For edgeR, either 'contrast' or 'coef'.</p></td>
    </tr>
    <tr>
      <th>comparison</th>
      <td><p>For DESeq2, the contrast or name. For edgeR, the coefficients or contrasts.</p></td>
    </tr>
    <tr>
      <th>shrink_lfc</th>
      <td><p>For DESeq2, whether the log2 fold changes are shrunk (TRUE) or not (FALSE).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>TSRexploreR object with results for given contrast.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Calculatse the differential TSSs or TSRs for the desired contrast.
'comparison_type' corresponds to the way the comparison will be performed,
  with edgeR having the 'contrast' and 'coef' options,
  and DESeq2 having the 'contrast' and 'name' options.
The actual contrast is specified with 'comparison',
  the format of which should match with the option provided to 'comparison_type'.
If DESeq2 is used and 'shrink_lfc' is TRUE,
  apeglm is used to shrink the Log2 fold changes to mitigate the effect size of
  genes with lower levels of expression.
The results for the contrast will be stored back into the TSRexploreR object with
  the name provided to 'comparison_name'.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='fit_de_model.html'>fit_de_model</a></code> to fit DEseq2 or edgeR model to data.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>TSSs</span><span class='op'>)</span>
<span class='va'>sample_sheet</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>
  sample_name<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>
    <span class='fu'><a href='https://rdrr.io/r/base/sprintf.html'>sprintf</a></span><span class='op'>(</span><span class='st'>"S288C_D_%s"</span>, <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>,
    <span class='fu'><a href='https://rdrr.io/r/base/sprintf.html'>sprintf</a></span><span class='op'>(</span><span class='st'>"S288C_WT_%s"</span>, <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>
  <span class='op'>)</span>,
  file_1<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='cn'>NA</span>, <span class='fl'>6</span><span class='op'>)</span>, file_2<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='cn'>NA</span>, <span class='fl'>6</span><span class='op'>)</span>,
  condition<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>
    <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"Diamide"</span>, <span class='fl'>3</span><span class='op'>)</span>,
    <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"Untreated"</span>, <span class='fl'>3</span><span class='op'>)</span>
  <span class='op'>)</span>
<span class='op'>)</span>

<span class='va'>exp</span> <span class='op'>&lt;-</span> <span class='va'>TSSs</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='tsr_explorer-class.html'>tsr_explorer</a></span><span class='op'>(</span>sample_sheet<span class='op'>=</span><span class='va'>sample_sheet</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='format_counts.html'>format_counts</a></span><span class='op'>(</span>data_type<span class='op'>=</span><span class='st'>"tss"</span><span class='op'>)</span>

<span class='co'># Differential TSSs with DESeq2.</span>
<span class='va'>exp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='fit_de_model.html'>fit_de_model</a></span><span class='op'>(</span><span class='va'>exp</span>, data_type<span class='op'>=</span><span class='st'>"tss"</span>, formula<span class='op'>=</span><span class='op'>~</span><span class='va'>condition</span>, method<span class='op'>=</span><span class='st'>"edgeR"</span><span class='op'>)</span>

<span class='va'>exp</span> <span class='op'>&lt;-</span> <span class='fu'>differential_expression</span><span class='op'>(</span>
  <span class='va'>exp</span>, data_type<span class='op'>=</span><span class='st'>"tss"</span>, 
  comparison_name<span class='op'>=</span><span class='st'>"Diamide_vs_Untreated"</span>,
  comparison_type<span class='op'>=</span><span class='st'>"coef"</span>,
  comparison<span class='op'>=</span><span class='fl'>2</span>
<span class='op'>)</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Robert Policastro.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


