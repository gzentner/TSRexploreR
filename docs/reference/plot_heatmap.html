<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Plot Heatmap — plot_heatmap • TSRexploreR</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Plot Heatmap — plot_heatmap" />
<meta property="og:description" content="Plot heatmap from count matrix generated by tss_heatmap_matrix or tsr_heatmap_matrix" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TSRexploreR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/BAM_PROCESSING.html">BAM Processing</a>
    </li>
    <li>
      <a href="../articles/DATA_CONDITIONING.html">Data Conditioning</a>
    </li>
    <li>
      <a href="../articles/DIFF_FEATURES.html">Differential Feature Analysis</a>
    </li>
    <li>
      <a href="../articles/FEATURE_SHIFT.html">TSS Shifting</a>
    </li>
    <li>
      <a href="../articles/STANDARD_ANALYSIS.html">Standard Analysis</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot Heatmap</h1>
    
    <div class="hidden name"><code>plot_heatmap.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Plot heatmap from count matrix generated by tss_heatmap_matrix or tsr_heatmap_matrix</p>
    </div>

    <pre class="usage"><span class='fu'>plot_heatmap</span><span class='op'>(</span>
  <span class='va'>experiment</span>,
  samples <span class='op'>=</span> <span class='st'>"all"</span>,
  data_type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"tss"</span>, <span class='st'>"tsr"</span><span class='op'>)</span>,
  upstream <span class='op'>=</span> <span class='fl'>1000</span>,
  downstream <span class='op'>=</span> <span class='fl'>1000</span>,
  threshold <span class='op'>=</span> <span class='cn'>NULL</span>,
  use_normalized <span class='op'>=</span> <span class='cn'>FALSE</span>,
  dominant <span class='op'>=</span> <span class='cn'>FALSE</span>,
  remove_antisense <span class='op'>=</span> <span class='cn'>TRUE</span>,
  rasterize <span class='op'>=</span> <span class='cn'>FALSE</span>,
  raster_dpi <span class='op'>=</span> <span class='fl'>150</span>,
  max_value <span class='op'>=</span> <span class='cn'>NULL</span>,
  low_color <span class='op'>=</span> <span class='st'>"white"</span>,
  high_color <span class='op'>=</span> <span class='st'>"blue"</span>,
  log2_transform <span class='op'>=</span> <span class='cn'>TRUE</span>,
  x_axis_breaks <span class='op'>=</span> <span class='fl'>100</span>,
  ncol <span class='op'>=</span> <span class='fl'>3</span>,
  filtering <span class='op'>=</span> <span class='cn'>NULL</span>,
  ordering <span class='op'>=</span> <span class='va'>score</span>,
  order_descending <span class='op'>=</span> <span class='cn'>TRUE</span>,
  order_fun <span class='op'>=</span> <span class='va'>sum</span>,
  order_samples <span class='op'>=</span> <span class='cn'>NULL</span>,
  quantiling <span class='op'>=</span> <span class='cn'>NULL</span>,
  quantile_fun <span class='op'>=</span> <span class='va'>sum</span>,
  n_quantiles <span class='op'>=</span> <span class='fl'>5</span>,
  quantile_samples <span class='op'>=</span> <span class='cn'>NULL</span>,
  split_by <span class='op'>=</span> <span class='cn'>NULL</span>,
  diff_heatmap_list <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>experiment</th>
      <td><p>TSRexploreR object.</p></td>
    </tr>
    <tr>
      <th>samples</th>
      <td><p>A vector of sample names to analyze.</p></td>
    </tr>
    <tr>
      <th>data_type</th>
      <td><p>Plot TSS ('tss') or TSR ('tsr') scores.</p></td>
    </tr>
    <tr>
      <th>upstream</th>
      <td><p>Bases upstream to consider</p></td>
    </tr>
    <tr>
      <th>downstream</th>
      <td><p>bases downstream to consider</p></td>
    </tr>
    <tr>
      <th>threshold</th>
      <td><p>TSSs or TSRs with a score below this value will not be considered.</p></td>
    </tr>
    <tr>
      <th>use_normalized</th>
      <td><p>Whether to use the normalized (TRUE) or raw (FALSE) counts.</p></td>
    </tr>
    <tr>
      <th>dominant</th>
      <td><p>If TRUE, will only consider the highest-scoring TSS per gene, transcript, or TSR or 
highest-scoring TSR per gene or transcript.</p></td>
    </tr>
    <tr>
      <th>remove_antisense</th>
      <td><p>Remove antisense reads.</p></td>
    </tr>
    <tr>
      <th>rasterize</th>
      <td><p>Rasterize a ggplot.</p></td>
    </tr>
    <tr>
      <th>raster_dpi</th>
      <td><p>If rasterization is set, this controls the rasterization DPI.</p></td>
    </tr>
    <tr>
      <th>max_value</th>
      <td><p>Truncate heatmap scale at this value.</p></td>
    </tr>
    <tr>
      <th>low_color</th>
      <td><p>Color for minimum value.</p></td>
    </tr>
    <tr>
      <th>high_color</th>
      <td><p>Color for maximum value.</p></td>
    </tr>
    <tr>
      <th>log2_transform</th>
      <td><p>Log2 + 1 transform values for plotting.</p></td>
    </tr>
    <tr>
      <th>x_axis_breaks</th>
      <td><p>The distance breaks to show values on the x-axis.</p></td>
    </tr>
    <tr>
      <th>ncol</th>
      <td><p>Integer specifying the number of columns to arrange multiple plots.</p></td>
    </tr>
    <tr>
      <th>filtering</th>
      <td><p>Logical statement by which to filter data.</p></td>
    </tr>
    <tr>
      <th>ordering</th>
      <td><p>Symbol/name specifying the column by which to order.</p></td>
    </tr>
    <tr>
      <th>order_descending</th>
      <td><p>Whether to order in descending (TRUE) order.</p></td>
    </tr>
    <tr>
      <th>order_fun</th>
      <td><p>Function to aggregate variable by before ordering.</p></td>
    </tr>
    <tr>
      <th>order_samples</th>
      <td><p>Samples that are used to calculate ordering.</p></td>
    </tr>
    <tr>
      <th>quantiling</th>
      <td><p>Character specifying column by which to quantile..</p></td>
    </tr>
    <tr>
      <th>quantile_fun</th>
      <td><p>Functiont o aggregate variable by before quantiling.</p></td>
    </tr>
    <tr>
      <th>n_quantiles</th>
      <td><p>Number of quantiles.</p></td>
    </tr>
    <tr>
      <th>quantile_samples</th>
      <td><p>Samples to use for quantiling.</p></td>
    </tr>
    <tr>
      <th>split_by</th>
      <td><p>Named list with split group as name and vector of genes,
or data.frame with columns 'feature' and 'split_group'.</p></td>
    </tr>
    <tr>
      <th>diff_heatmap_list</th>
      <td><p>Named list if sample pairs.
The name will be the comparison name,</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments passed to Heatmap</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>ggplot2 object of TSS or TSR heatmap</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This plotting function generates a ggplot2 heatmap of TSS or TSR signal
  surrounding the annotated TSSs of genes or transcripts.
Whether genes or transcripts are used depends on the feature type chosen
  when annotating the TSSs with the 'annotate_features' function.</p>
<p>The region around the annotated TSS used for plotting is controlled by
  'upstream' and 'downstream', which should be positive integers.</p>
<p>A set of arguments to control data structure for plotting are included.
'use_normalized' will use the normalized scores as opposed to raw read counts.
'threshold' definites the minimum number of reads a TSS or TSR
 must have to be considered.
'dominant' specifies whether only the dominant TSS or TSR is considered 
  from the 'mark_dominant' function.
For TSSs this can be either dominant per TSR or gene, and for TSRs
  it is just the dominant TSR per gene.</p>
<p>A set of arguments for data conditions are supplied seperatly from
  the 'conditionals' function used in many other core functions.
This is because each row (feature) can have multiple TSSs or TSRs,
  which is unique to this type of plot.
'filtering' can be supplied with a logical statement to filter TSSs and TSRs
  by the given condition(s).
'ordering' can be supplied with a symbol/name of the variable to order by,
  and 'order_descending' controls ordering direction.
'order_fun' is the function used to aggregate the variable score for each row/feature,
  and 'order_sample' controls the samples used to order from these aggregated variables.
'quantiling' is a character specifying the numeric variable to quantile by,
  and 'n_quantiles' controls the number of quantiles to split the data into.
Just as with ordering, 'quantiles_fun' is the function to aggregate the numeric
  variable by per feature/row, and 'quantile_samples' are the samples used to
  determine the order.
Finally, 'split_by' can be given either a two column data.frame ('feature' and 'split_group'),
  or a named list, where the names are the split category and the list contents are
  a vector of genes.</p>
<p>An option to rasterize the heatmaps using ggrastr is provided with the 'rasterize' argument,
  and the DPI (resolution) is controlled by 'raster_dpi'.</p>
<p>If diff_heatmap_list is given, the heatmaps will represent the subtracted
  score between the sample pairs provided in the list.
If this argument is given the only data conditionals that will work are ordering related.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='annotate_features.html'>annotate_features</a></code> to annotate the TSSs or TSRs.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>TSSs_reduced</span><span class='op'>)</span>
<span class='va'>annotation</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"extdata"</span>, <span class='st'>"S288C_Annotation.gtf"</span>, package<span class='op'>=</span><span class='st'>"TSRexploreR"</span><span class='op'>)</span>

<span class='va'>exp</span> <span class='op'>&lt;-</span> <span class='va'>TSSs_reduced</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='tsr_explorer-class.html'>tsr_explorer</a></span><span class='op'>(</span>genome_annotation<span class='op'>=</span><span class='va'>annotation</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='format_counts.html'>format_counts</a></span><span class='op'>(</span>data_type<span class='op'>=</span><span class='st'>"tss"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='annotate_features.html'>annotate_features</a></span><span class='op'>(</span>data_type<span class='op'>=</span><span class='st'>"tss"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Import genomic features from the file as a GRanges object ... </span></div><div class='output co'>#&gt; <span class='message'>OK</span></div><div class='output co'>#&gt; <span class='message'>Prepare the 'metadata' data frame ... </span></div><div class='output co'>#&gt; <span class='message'>OK</span></div><div class='output co'>#&gt; <span class='message'>Make the TxDb object ... </span></div><div class='output co'>#&gt; <span class='warning'>Warning: The "phase" metadata column contains non-NA values for features of type</span>
#&gt; <span class='warning'>  stop_codon. This information was ignored.</span></div><div class='output co'>#&gt; <span class='message'>OK</span></div><div class='input'>
<span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'>plot_heatmap</span><span class='op'>(</span><span class='va'>exp</span>, data_type<span class='op'>=</span><span class='st'>"tss"</span><span class='op'>)</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Robert Policastro.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


